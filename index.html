<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educa DQ EAD</title>
    <style>
        :root { --primary: #1a1a2e; --accent: #e94560; --bg: #f4f7f6; --white: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); }
        .hidden { display: none !important; }
        
        /* Layout */
        .wrapper { display: flex; min-height: 100vh; }
        .sidebar { width: 260px; background: var(--primary); color: white; padding: 20px; }
        .main { flex: 1; padding: 30px; }
        .nav-item { padding: 15px; cursor: pointer; border-radius: 8px; margin-bottom: 5px; }
        .nav-item:hover, .active { background: var(--accent); }

        /* Cards de Cursos */
        .grid-cursos { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card-curso { background: var(--white); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); cursor: pointer; transition: 0.3s; }
        .card-curso:hover { transform: translateY(-5px); }
        .card-curso img { width: 100%; height: 160px; object-fit: cover; }
        .card-body { padding: 15px; text-align: center; }

        /* Lista de Aulas (Grade) */
        .aula-item { background: var(--white); padding: 15px; margin-bottom: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--accent); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn-play { background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }

        /* Forms */
        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        .btn-save { background: #27ae60; color: white; border: none; padding: 12px; width: 100%; border-radius: 6px; cursor: pointer; font-weight: bold; }

        /* Login */
        #login-screen { display: flex; justify-content: center; align-items: center; height: 100vh; background: var(--primary); }
        .login-box { background: white; padding: 40px; border-radius: 12px; width: 350px; text-align: center; }

        /* Video */
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; background: #000; border-radius: 10px; overflow: hidden; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body>

    <section id="login-screen">
        <div class="login-box">
            <h2>Educa DQ Login</h2>
            <input type="text" id="user" placeholder="Usu√°rio (admin/aluno)">
            <input type="password" id="pass" placeholder="Senha (123)">
            <button class="btn-save" style="background: var(--accent);" onclick="login()">Entrar</button>
        </div>
    </section>

    <section id="dash-screen" class="hidden">
        <div class="wrapper">
            <nav class="sidebar">
                <h2 id="role-label">Portal Educa EAD</h2>
                <div class="nav-item" onclick="showTab('tab-catalogo')">üìö Meus Cursos</div>
                <div id="adm-menu" class="hidden">
                    <div class="nav-item" onclick="showTab('tab-add-curso')">üìÅ Novo Curso</div>
                    <div class="nav-item" onclick="showTab('tab-add-aula')">üé¨ Adicionar Aula</div>
                </div>
                <div class="nav-item" style="margin-top:20px; opacity:0.7" onclick="location.reload()">üö™ Sair</div>
            </nav>

            <main class="main">
                <div id="tab-catalogo" class="tab-content">
                    <h1>Meus Cursos</h1>
                    <div id="lista-cursos-cards" class="grid-cursos"></div>
                </div>

                <div id="tab-grade" class="tab-content hidden">
                    <button onclick="showTab('tab-catalogo')">‚¨Ö Voltar aos Cursos</button>
                    <h1 id="nome-curso-selecionado">Nome do Curso</h1>
                    <div id="lista-aulas-grade"></div>
                </div>

                <div id="tab-player" class="tab-content hidden">
                    <button id="btn-voltar-grade">‚¨Ö Voltar para Grade</button>
                    <h2 id="titulo-aula-atual">Aula</h2>
                    <div class="video-container">
                        <iframe id="video-iframe" src="" allowfullscreen referrerpolicy="strict-origin-when-cross-origin"></iframe>
                    </div>
                </div>

                <div id="tab-add-curso" class="tab-content hidden">
                    <h1>Cadastrar Novo Curso</h1>
                    <div style="max-width: 400px; background: white; padding: 20px; border-radius: 10px;">
                        <input type="text" id="new-curso-nome" placeholder="Nome do Curso (Ex: Teologia)">
                        <input type="text" id="new-curso-capa" placeholder="URL da Imagem da Capa">
                        <button class="btn-save" onclick="salvarCurso()">Criar Curso</button>
                    </div>
                </div>

                <div id="tab-add-aula" class="tab-content hidden">
                    <h1>Adicionar Aula em um Curso</h1>
                    <div style="max-width: 400px; background: white; padding: 20px; border-radius: 10px;">
                        <select id="select-curso-destino"></select>
                        <input type="text" id="new-aula-nome" placeholder="T√≠tulo da Aula">
                        <input type="text" id="new-aula-url" placeholder="Link do YouTube">
                        <button class="btn-save" onclick="salvarAula()">Vincular Aula</button>
                    </div>
                </div>
            </main>
        </div>
    </section>

    <script>
        // Estrutura de dados: Cursos cont√™m um array de aulas
        let cursos = JSON.parse(localStorage.getItem('ead_db_v3')) || [
            { nome: "Boas Vindas", capa: "https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=500", aulas: [] }
        ];
        let tipoUsuario = "";
        let cursoAtualIndex = null;

        function login() {
            const u = document.getElementById('user').value.toLowerCase();
            const p = document.getElementById('pass').value;
            if(p === '123' && (u === 'admin' || u === 'aluno')) {
                tipoUsuario = u;
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('dash-screen').classList.remove('hidden');
                if(u === 'admin') document.getElementById('adm-menu').classList.remove('hidden');
                renderCursos();
            } else { alert("Acesso inv√°lido!"); }
        }

        function formatLink(url) {
            let id = url.includes("v=") ? url.split("v=")[1].split("&")[0] : url.split("/").pop();
            return `https://www.youtube.com/embed/${id}?rel=0&origin=${window.location.origin}`;
        }

        // --- FUN√á√ïES DE RENDERIZA√á√ÉO ---

        function renderCursos() {
            const container = document.getElementById('lista-cursos-cards');
            const select = document.getElementById('select-curso-destino');
            container.innerHTML = "";
            select.innerHTML = "<option value=''>Selecione o curso...</option>";

            cursos.forEach((curso, index) => {
                // Card no cat√°logo
                container.innerHTML += `
                    <div class="card-curso" onclick="verGrade(${index})">
                        <img src="${curso.capa}">
                        <div class="card-body">
                            <h3>${curso.nome}</h3>
                            <p>${curso.aulas.length} aula(s)</p>
                        </div>
                    </div>
                `;
                // Op√ß√£o no select do admin
                select.innerHTML += `<option value="${index}">${curso.nome}</option>`;
            });
        }

        function verGrade(index) {
            cursoAtualIndex = index;
            const curso = cursos[index];
            document.getElementById('nome-curso-selecionado').innerText = curso.nome;
            const containerAulas = document.getElementById('lista-aulas-grade');
            containerAulas.innerHTML = curso.aulas.length === 0 ? "Nenhuma aula cadastrada." : "";

            curso.aulas.forEach((aula, aIndex) => {
                containerAulas.innerHTML += `
                    <div class="aula-item">
                        <span><strong>Aula ${aIndex + 1}:</strong> ${aula.nome}</span>
                        <button class="btn-play" onclick="assistir('${aula.url}', '${aula.nome}')">Assistir</button>
                    </div>
                `;
            });
            showTab('tab-grade');
        }

        function assistir(url, titulo) {
            document.getElementById('titulo-aula-atual').innerText = titulo;
            document.getElementById('video-iframe').src = url;
            document.getElementById('btn-voltar-grade').onclick = () => verGrade(cursoAtualIndex);
            showTab('tab-player');
        }

        // --- FUN√á√ïES DE SALVAMENTO (ADMIN) ---

        function salvarCurso() {
            const nome = document.getElementById('new-curso-nome').value;
            const capa = document.getElementById('new-curso-capa').value || "https://via.placeholder.com/300x160?text=Curso";
            if(!nome) return alert("Digite o nome do curso");
            
            cursos.push({ nome, capa, aulas: [] });
            localStorage.setItem('ead_db_v3', JSON.stringify(cursos));
            alert("Curso Criado!");
            renderCursos();
            showTab('tab-catalogo');
        }

        function salvarAula() {
            const cIndex = document.getElementById('select-curso-destino').value;
            const nome = document.getElementById('new-aula-nome').value;
            const url = document.getElementById('new-aula-url').value;

            if(cIndex === "" || !nome || !url) return alert("Preencha todos os dados da aula");

            cursos[cIndex].aulas.push({ nome, url: formatLink(url) });
            localStorage.setItem('ead_db_v3', JSON.stringify(cursos));
            alert("Aula adicionada ao curso!");
            renderCursos();
            showTab('tab-catalogo');
        }

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }
    </script>
</body>
</html>
